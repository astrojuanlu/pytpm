

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Coordinate conversions using TPM and PyTPM &mdash; PyTPM 0.7.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PyTPM 0.7.1 documentation" href="index.html" />
    <link rel="next" title="Comparison of PyTPM with SLALIB" href="comparisons.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="comparisons.html" title="Comparison of PyTPM with SLALIB"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PyTPM 0.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="coordinate-conversions-using-tpm-and-pytpm">
<h1><a class="toc-backref" href="#id1">Coordinate conversions using TPM and PyTPM</a><a class="headerlink" href="#coordinate-conversions-using-tpm-and-pytpm" title="Permalink to this headline">¶</a></h1>
<p>Please read the <a class="reference internal" href="index.html#tpm-manual"><em>TPM manual</em></a> to learn the details of
using TPM for performing coordinate conversions.</p>
<p>For a detailed list of functions and constants defined in PyTPM, see
the section on <a class="reference internal" href="functions.html"><em>Functions and constants in PyTPM</em></a>. For detailed information on the data
structures defined in PyTPM, see the section on <a class="reference internal" href="data_structures.html"><em>Data Structures</em></a>.</p>
<p>See <a class="reference internal" href="comparisons.html"><em>Comparison of PyTPM with SLALIB</em></a> for a comparison of results obtained using
PyTPM, with those obtained using SLALIB.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#coordinate-conversions-using-tpm-and-pytpm" id="id1">Coordinate conversions using TPM and PyTPM</a><ul>
<li><a class="reference internal" href="#function-convert-convertv6" id="id2">Function <cite>convert.convertv6</cite></a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-fk4-equinox-and-epoch-b1950-0" id="id3">FK5 equinox and epoch J2000.0, to FK4 equinox and epoch B1950.0</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-iau-1958-galactic-system" id="id4">FK5 equinox and epoch J2000.0, to IAU 1958 Galactic System</a></li>
<li><a class="reference internal" href="#iau-1958-galactic-to-fk5-equinox-and-epoch-j2000-0" id="id5">IAU 1958 Galactic, to FK5 equinox and epoch J2000.0</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-iau-1980-ecliptic-system" id="id6">FK5 equinox and epoch J2000.0, to IAU 1980 Ecliptic system</a></li>
<li><a class="reference internal" href="#iau-1980-ecliptic-system-to-fk5-equinox-and-epoch-j2000-0" id="id7">IAU 1980 Ecliptic system, to FK5 equinox and epoch J2000.0</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-geocentric-apparent" id="id8">FK5 equinox and epoch J2000.0, to Geocentric apparent</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-topocentric-observed" id="id9">FK5 equinox and epoch J2000.0, to topocentric observed</a></li>
<li><a class="reference internal" href="#converting-positions-and-velocities" id="id10">Converting positions and velocities</a></li>
<li><a class="reference internal" href="#pytpm-and-tpm" id="id11">PyTPM and TPM</a><ul>
<li><a class="reference internal" href="#c-code" id="id12">C code</a></li>
<li><a class="reference internal" href="#pytpm-code" id="id13">PyTPM code</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>In this document several examples of using PyTPM module for performing
coordinate conversions will be presented.</p>
<p>In the following examples <a class="reference external" href="http://simbad.u-strasbg.fr/simbad/sim-basic?Ident=M100&amp;submit=SIMBAD+search">coordinates of M100</a> is converted between
different systems. TPM can convert both positions and velocities. For
M100 only the position are significant, except for the FK5-FK4
conversion. The section <a class="reference internal" href="#convert-pos-vel"><em>Converting positions and velocities</em></a> has examples of
converting positions and velocities, with data from HIPPARCOS catalog.
Also, the examples here use the convenience function
<a class="reference internal" href="functions.html#pytpm.convert.convertv6" title="pytpm.convert.convertv6"><tt class="xref py py-func docutils literal"><span class="pre">convert.convertv6()</span></tt></a>, instead of directly using the
underlying TPM functions.</p>
<p>As mentioned before, facilities in TPM that are wrapped by PyTPM are
provided in the module <cite>pytpm.tpm</cite>. The <cite>pytpm.convert</cite>
module contains a few convenience functions for performing coordinate
conversions. We can load both of these modules in the following manner.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytpm</span> <span class="kn">import</span> <span class="n">tpm</span><span class="p">,</span> <span class="n">convert</span>
</pre></div>
</div>
<div class="section" id="function-convert-convertv6">
<h2><a class="toc-backref" href="#id2">Function <cite>convert.convertv6</cite></a><a class="headerlink" href="#function-convert-convertv6" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="functions.html#pytpm.convert.convertv6" title="pytpm.convert.convertv6"><tt class="xref py py-func docutils literal"><span class="pre">convert.convertv6()</span></tt></a> function aims to present an easy to use
interface to TPM that allows easy coordinate conversions. It takes a
large set of input, sets up TPM, performs the conversions, and returns
the final coordinates. The source code of this function also serves as
an example of using TPM.</p>
<p>This function takes the following arguments. Not all of these need to
be specified for a given conversion.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>v6</td>
<td>one V6C vector or a list of V6C vectors.</td>
</tr>
<tr class="row-odd"><td>s1</td>
<td>start state</td>
</tr>
<tr class="row-even"><td>s2</td>
<td>end state</td>
</tr>
<tr class="row-odd"><td>epoch</td>
<td>epoch of the coordinates as a Julian date</td>
</tr>
<tr class="row-even"><td>equinox</td>
<td>equinox of the coordinates as Julian date</td>
</tr>
<tr class="row-odd"><td>utc</td>
<td>time of &#8220;observation&#8221; as a Julian date;
exact meaning depends on the type of conversion;
defaults to the epoch J2000.0</td>
</tr>
<tr class="row-even"><td>delta_ut</td>
<td>UT1 - UTC in seconds.</td>
</tr>
<tr class="row-odd"><td>delta_at</td>
<td>TAI - UTC in seconds.</td>
</tr>
<tr class="row-even"><td>lon</td>
<td>geodetic longitude in degrees</td>
</tr>
<tr class="row-odd"><td>lat</td>
<td>geodetic latitude in degrees</td>
</tr>
<tr class="row-even"><td>alt</td>
<td>altitude in meters</td>
</tr>
<tr class="row-odd"><td>xpole</td>
<td>ploar motion in radians</td>
</tr>
<tr class="row-even"><td>ypole</td>
<td>ploar motion in radians</td>
</tr>
<tr class="row-odd"><td>T</td>
<td>temperature in kelvin</td>
</tr>
<tr class="row-even"><td>P</td>
<td>pressure in milli-bars</td>
</tr>
<tr class="row-odd"><td>H</td>
<td>relative humidity (0-1)</td>
</tr>
<tr class="row-even"><td>wavelength</td>
<td>wavelength of observation in microns</td>
</tr>
</tbody>
</table>
<p>A <a class="reference internal" href="data_structures.html#pytpm.tpm.V6C" title="pytpm.tpm.V6C"><tt class="xref py py-class docutils literal"><span class="pre">tpm.V6C</span></tt></a> object is a 6-D vector that stores positions and
velocities in Cartesian coordinates.</p>
<p>The function <a class="reference internal" href="functions.html#pytpm.convert.cat2v6" title="pytpm.convert.cat2v6"><tt class="xref py py-func docutils literal"><span class="pre">convert.cat2v6()</span></tt></a> can be used to create a <cite>V6C</cite>
object from catalog data.  This function will accept scalar or list of
coordinates, and will return a list of <cite>V6C</cite> vectors.</p>
<p>Function <a class="reference internal" href="functions.html#pytpm.convert.v62cat" title="pytpm.convert.v62cat"><tt class="xref py py-func docutils literal"><span class="pre">convert.v62cat()</span></tt></a> can convert <cite>V6C</cite> objects to catalog
coordinates. The coordinates are returned as a dictionary. This
function will also take a list of <cite>V6C</cite> objects and will return a list
of dictionaries.</p>
<p>Coordinate systems in TPM are specified using integers or integer
constants. These are referred to as <cite>states</cite>.The following lists the
states defined in TPM. Note that each of these states are just
integers: <tt class="docutils literal"><span class="pre">TPM_S02</span> <span class="pre">==</span> <span class="pre">2</span></tt>, <tt class="docutils literal"><span class="pre">TPM_S13</span> <span class="pre">==</span> <span class="pre">13</span></tt> and so on.</p>
<table border="1" class="docutils" id="tpm-state-names">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">State</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>TPM_S00</td>
<td>Null</td>
</tr>
<tr class="row-odd"><td>TPM_S01</td>
<td>Heliocentric mean FK4 system, any equinox</td>
</tr>
<tr class="row-even"><td>TPM_S02</td>
<td>Heliocentric mean FK5 system, any equinox</td>
</tr>
<tr class="row-odd"><td>TPM_S03</td>
<td>IAU 1980 Ecliptic system</td>
</tr>
<tr class="row-even"><td>TPM_S04</td>
<td>IAU 1958 Galactic system</td>
</tr>
<tr class="row-odd"><td>TPM_S05</td>
<td>Heliocentric mean FK4 system, B1950 equinox</td>
</tr>
<tr class="row-even"><td>TPM_S06</td>
<td>Heliocentric mean FK5 system, J2000 equinox</td>
</tr>
<tr class="row-odd"><td>TPM_S07</td>
<td>Geocentric mean FK5 system, J2000 equinox</td>
</tr>
<tr class="row-even"><td>TPM_S08</td>
<td>TPM_S07 + light deflection</td>
</tr>
<tr class="row-odd"><td>TPM_S09</td>
<td>TPM_S08 + Aberration</td>
</tr>
<tr class="row-even"><td>TPM_S10</td>
<td>TPM_S09 + precession</td>
</tr>
<tr class="row-odd"><td>TPM_S11</td>
<td>Geocentric apparent FK5, current equinox</td>
</tr>
<tr class="row-even"><td>TPM_S12</td>
<td>Topocentric mean FK5, J2000 equinox</td>
</tr>
<tr class="row-odd"><td>TPM_S13</td>
<td>TPM_S12 + light definition</td>
</tr>
<tr class="row-even"><td>TPM_S14</td>
<td>TPM_S13 + aberration</td>
</tr>
<tr class="row-odd"><td>TPM_S15</td>
<td>TPM_S14 + precession</td>
</tr>
<tr class="row-even"><td>TPM_S16</td>
<td>Topocentric apparent FK5, current equinox</td>
</tr>
<tr class="row-odd"><td>TPM_S17</td>
<td>Topocentric apparent FK5, current equnix</td>
</tr>
<tr class="row-even"><td>TPM_S18</td>
<td>Topocentric apparent (Hour Angle, Declination)</td>
</tr>
<tr class="row-odd"><td>TPM_S19</td>
<td>Topocentric observed (Azimuth, Elevation)</td>
</tr>
<tr class="row-even"><td>TPM_S20</td>
<td>Topocentric observed (Hour Angle, Declination)</td>
</tr>
<tr class="row-odd"><td>TPM_S21</td>
<td>Topocentric observed WHAM (longitude, latitude)</td>
</tr>
</tbody>
</table>
<p>Some of these states have additional special names.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">State</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>TARGET_FK4</td>
<td>TPM_S01</td>
</tr>
<tr class="row-odd"><td>TARGET_FK5</td>
<td>TPM_S02</td>
</tr>
<tr class="row-even"><td>TARGET_ECL</td>
<td>TPM_S03</td>
</tr>
<tr class="row-odd"><td>TARGET_GAL</td>
<td>TPM_S04</td>
</tr>
<tr class="row-even"><td>TARGET_APP_HADEC</td>
<td>TPM_S17</td>
</tr>
<tr class="row-odd"><td>TARGET_OBS_HADEC</td>
<td>TPM_S20</td>
</tr>
<tr class="row-even"><td>TARGET_APP_AZEL</td>
<td>TPM_S18</td>
</tr>
<tr class="row-odd"><td>TARGET_OBS_AZEL</td>
<td>TPM_S19</td>
</tr>
<tr class="row-even"><td>TARGET_OBS_WHAM</td>
<td>TPM_S21</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="fk5-equinox-and-epoch-j2000-0-to-fk4-equinox-and-epoch-b1950-0">
<h2><a class="toc-backref" href="#id3">FK5 equinox and epoch J2000.0, to FK4 equinox and epoch B1950.0</a><a class="headerlink" href="#fk5-equinox-and-epoch-j2000-0-to-fk4-equinox-and-epoch-b1950-0" title="Permalink to this headline">¶</a></h2>
<p>First obtain the <cite>FK5 equinox J2000.0 and epoch J2000.0</cite> RA and Dec
coordinates in radians.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ra_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">hh</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">54.899</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dec_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">dd</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">20.57</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a <a class="reference internal" href="data_structures.html#pytpm.tpm.V6C" title="pytpm.tpm.V6C"><tt class="xref py py-class docutils literal"><span class="pre">tpm.V6C</span></tt></a> vector for the object. Note
that <a class="reference internal" href="functions.html#pytpm.convert.cat2v6" title="pytpm.convert.cat2v6"><tt class="xref py py-func docutils literal"><span class="pre">convert.cat2v6()</span></tt></a> will accept a list of coordinates as well.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">ra_j2000</span><span class="p">,</span> <span class="n">dec_j2000</span><span class="p">)</span>
</pre></div>
</div>
<p>Now convert to <cite>FK4 equinox B1950.0, but remaining at epoch J2000.0</cite>.</p>
<p>In the following <cite>6</cite> stands for <cite>FK5 equinox J2000.0</cite> coordinates and
<cite>5</cite> stands for <cite>FK4 equinox B1950.0</cite>. The epoch and equinox are
specified using <cite>epoch</cite> and <cite>equinox</cite> keywords. They can be interpreted
in different ways depending on the exact conversion requested. They are
also used only for certain calculations. In the present case, they are
applicable to the input coordinates. Read the <a class="reference internal" href="index.html#tpm-manual"><em>TPM manual</em></a> for more information.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v6_fk4</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">,</span>
<span class="go">   ...: equinox=tpm.J2000)</span>
</pre></div>
</div>
<p>Convert <cite>V6C</cite> to catalog data and print results. Function
<a class="reference internal" href="functions.html#pytpm.convert.v62cat" title="pytpm.convert.v62cat"><tt class="xref py py-func docutils literal"><span class="pre">convert.v62cat()</span></tt></a> will also accept a list of V6C vectors.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_fk4</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">CB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go"> 12H 20M 22.935S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">+16D 05&#39; 58.024&quot;</span>
</pre></div>
</div>
<p>The parameter <cite>C</cite> is the number of days in a century. The velocities in
<a class="reference internal" href="data_structures.html#pytpm.tpm.V6C" title="pytpm.tpm.V6C"><tt class="xref py py-class docutils literal"><span class="pre">tpm.V6C</span></tt></a> vectors are stored AU/day. These Cartesian velocities
must be converted to catalog proper motions. The latter are expressed
in arc-secs/century.</p>
<p>In the Besselian system a century has approximately 36524.22 days,
where as in the Julian system a century has exactly 36525.0 days. The
former is used in FK4 and the latter is used in FK5. The default value
is set to 36525.0. These two values are provided as the constants
<cite>tpm.CB</cite> and <cite>tpm.CJ</cite>, respectively; see <a class="reference internal" href="functions.html#tpm-constants"><em>Constants</em></a>.</p>
<p>Note that the results above <em>do not agree</em> with the FK4 values given by
SIMBAD. This is because the results are for the epoch J2000.0, i.e.,
<cite>FK4 equinox B1950.0 epoch J2000.0</cite>. Even though the object doesn&#8217;t
have proper motion, the FK4 system is rotating with respect to
FK5. This results in a <em>fictitious proper motion in the FK4 system</em>. We
must apply proper motion from epoch J2000.0 to epoch B1950.0 to get the
final result, i.e., FK4 equinox B1950.0 epoch B1950.0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v6_fk4_ep1950</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">proper_motion</span><span class="p">(</span><span class="n">v6_fk4</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">B1950</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally convert <cite>V6C</cite> to catalog data and print results. The final
result is in <cite>FK4 equinox and epoch B1950.0</cite>. The final results agree
with the values given by SIMBAD.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_fk4_ep1950</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">CB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go"> 12H 20M 22.943S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">+16D 05&#39; 58.241&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="fk5-equinox-and-epoch-j2000-0-to-iau-1958-galactic-system">
<h2><a class="toc-backref" href="#id4">FK5 equinox and epoch J2000.0, to IAU 1958 Galactic System</a><a class="headerlink" href="#fk5-equinox-and-epoch-j2000-0-to-iau-1958-galactic-system" title="Permalink to this headline">¶</a></h2>
<p>The IAU 1958 galactic system is represented using state <cite>4</cite>. The result
below is for the epoch J2000.0, since the input coordinates are at
epoch J2000.0. The epoch of the galactic coordinates given by SIMBAD is
J2000.0. So the result obtained below is what we need, i.e., we don&#8217;t
need to apply any proper motion corrections.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ra_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">hh</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">54.899</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dec_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">dd</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">20.57</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">ra_j2000</span><span class="p">,</span> <span class="n">dec_j2000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">v6_gal</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">,</span>
<span class="go">   ...: equinox=tpm.J2000)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_gal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go">271.136139562</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">76.8988689751</span>
</pre></div>
</div>
</div>
<div class="section" id="iau-1958-galactic-to-fk5-equinox-and-epoch-j2000-0">
<h2><a class="toc-backref" href="#id5">IAU 1958 Galactic, to FK5 equinox and epoch J2000.0</a><a class="headerlink" href="#iau-1958-galactic-to-fk5-equinox-and-epoch-j2000-0" title="Permalink to this headline">¶</a></h2>
<p>Here we set the starting state to galactic i.e., <cite>4</cite> and the end state
to FK5 equinox. Since the input coordinates are at epoch J2000.0, the
final results will also be at epoch J2000.0, i.e., FK5 equinox and
epoch J2000.0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gal_lon</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mf">271.1361</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gal_lat</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mf">76.8989</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">gal_lon</span><span class="p">,</span> <span class="n">gal_lat</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">v6_fk5</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_fk5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go"> 12H 22M 54.900S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">+15D 49&#39; 20.683&quot;</span>
</pre></div>
</div>
<p>The results are consistent with the accuracy of the input galactic
coordinates. When converting from Galactic to FK5, we pass through the
FK4 system. The lack of proper motion information in the Galactic
system affects the accuracy here. Usually, in catalogs we are
interested in converting FK5 to Galactic, and we do not notice this.</p>
</div>
<div class="section" id="fk5-equinox-and-epoch-j2000-0-to-iau-1980-ecliptic-system">
<h2><a class="toc-backref" href="#id6">FK5 equinox and epoch J2000.0, to IAU 1980 Ecliptic system</a><a class="headerlink" href="#fk5-equinox-and-epoch-j2000-0-to-iau-1980-ecliptic-system" title="Permalink to this headline">¶</a></h2>
<p>The ecliptic system is indicated using the state <cite>3</cite>. Here the epoch of
the output ecliptic coordinates will be J2000.0, as the input
coordinates are at epoch J2000.0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ra_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">hh</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">54.899</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dec_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">dd</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">20.57</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">ra_j2000</span><span class="p">,</span> <span class="n">dec_j2000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">v6_ecl</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">,</span>
<span class="go">   ...: equinox=tpm.J2000)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_ecl</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go">178.78256462</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">16.7597002513</span>
</pre></div>
</div>
<p>The results agree with the results from the SLALIB (<a class="reference external" href="https://github.com/scottransom/pyslalib">pyslalib</a>) routine
<cite>sla_eqecl</cite>.</p>
<p>See <a class="reference internal" href="comparisons.html"><em>Comparison of PyTPM with SLALIB</em></a> for a more detailed comparison between PyTPM and
SLALIB.</p>
</div>
<div class="section" id="iau-1980-ecliptic-system-to-fk5-equinox-and-epoch-j2000-0">
<h2><a class="toc-backref" href="#id7">IAU 1980 Ecliptic system, to FK5 equinox and epoch J2000.0</a><a class="headerlink" href="#iau-1980-ecliptic-system-to-fk5-equinox-and-epoch-j2000-0" title="Permalink to this headline">¶</a></h2>
<p>The starting state is set to <cite>3</cite> for ecliptic and the end state is set
to <cite>6</cite> for FK5 equinox J2000.0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ecl_lon</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mf">178.78256462</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ecl_lat</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mf">16.7597002513</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">ecl_lon</span><span class="p">,</span> <span class="n">ecl_lat</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">v6_fk5</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_fk5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go"> 12H 22M 54.898S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">+15D 49&#39; 20.570&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="fk5-equinox-and-epoch-j2000-0-to-geocentric-apparent">
<h2><a class="toc-backref" href="#id8">FK5 equinox and epoch J2000.0, to Geocentric apparent</a><a class="headerlink" href="#fk5-equinox-and-epoch-j2000-0-to-geocentric-apparent" title="Permalink to this headline">¶</a></h2>
<p>Geocentric apparent RA &amp; Dec. for midnight of 2010/1/1 can be
calculated as shown below. The state identification number for
geocentric apparent position is <cite>11</cite>, as shown in the <a class="reference internal" href="#tpm-state-names"><em>table above</em></a>.</p>
<p>Obtain UTC and TDB time for the time of observation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">utc</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">gcal2j</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>  <span class="c"># midnight</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tdb</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">utc2tdb</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
</pre></div>
</div>
<p>Obtain coordinates and <tt class="xref py py-class docutils literal"><span class="pre">V6C</span></tt> vector.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ra_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">hh</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">54.899</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dec_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">dd</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">20.57</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">ra_j2000</span><span class="p">,</span> <span class="n">dec_j2000</span><span class="p">)</span>
</pre></div>
</div>
<p>Apply proper motion from epoch J2000.0 to epoch of observation. In this
example, this is not needed since proper motion is zero. But we do this
for completeness. The result is FK5 J2000 current epoch.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">proper_motion</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert coordinates from FK5 equinox J2000, current epoch to FK5
equinox and epoch of date.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v6_gc</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_gc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go">185.860038856</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">15.7631353482</span>
</pre></div>
</div>
<p>The result from SLALIB (<a class="reference external" href="https://github.com/scottransom/pyslalib">pyslalib</a>) for the equivalent conversion, using
the <cite>sla_map</cite> function is given below.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">utc</span> <span class="o">=</span> <span class="n">slalib</span><span class="o">.</span><span class="n">sla_caldj</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c"># midnight</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tt</span> <span class="o">=</span> <span class="n">slalib</span><span class="o">.</span><span class="n">sla_dtt</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span> <span class="o">/</span> <span class="mf">86400.0</span> <span class="o">+</span> <span class="n">utc</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">slalib</span><span class="o">.</span><span class="n">sla_map</span><span class="p">(</span><span class="n">ra_j2000</span><span class="p">,</span> <span class="n">dec_j2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2000.0</span><span class="p">,</span>
<span class="go">   ...: tt)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">185.86002229414245</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">15.763142468669891</span>
</pre></div>
</div>
<p>The difference is about 0.06 arc-sec in RA and about 0.03 arc-sec
in Dec.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="mf">185.860038856</span><span class="p">)</span> <span class="o">*</span> <span class="mf">3600.0</span>
<span class="go">-0.059622687126648088</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="mf">15.7631353482</span><span class="p">)</span> <span class="o">*</span> <span class="mf">3600.0</span>
<span class="go">0.025633691604554087</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="comparisons.html"><em>Comparison of PyTPM with SLALIB</em></a> for a more detailed comparison between PyTPM and
SLALIB.</p>
</div>
<div class="section" id="fk5-equinox-and-epoch-j2000-0-to-topocentric-observed">
<h2><a class="toc-backref" href="#id9">FK5 equinox and epoch J2000.0, to topocentric observed</a><a class="headerlink" href="#fk5-equinox-and-epoch-j2000-0-to-topocentric-observed" title="Permalink to this headline">¶</a></h2>
<p>Topocentric observed azimuth and elevation (and zenith distance) for an
observer at the default location (KPNO) is calculated for 2010/1/1
mid-day. The final state i.e., apparent topocentric Az &amp; El, is <cite>19</cite>.</p>
<p>For midnight 2010/1/1 this object is below the horizon and hence the
refraction calculations are not reliable. So we use mid-day for the
following example.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">utc</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">gcal2j</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c"># mid-day</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tt</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">utc2tdb</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ra_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">hh</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">54.899</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dec_j2000</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">dd</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mm</span><span class="o">=</span><span class="mi">49</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="mf">20.57</span><span class="p">)</span><span class="o">.</span><span class="n">to_radians</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">ra_j2000</span><span class="p">,</span> <span class="n">dec_j2000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">proper_motion</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">v6_app</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="n">utc</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_app</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">]),</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">133.49820871 22.0162437585</span>
</pre></div>
</div>
<p>To calculate the observed hour angle and declination the <cite>v6_app</cite>
vector obtained above can be used as input. We don&#8217;t need to go back to
the FK5 equinox and epoch J2000.0 values. The input state is now <cite>19</cite>
and the output, i.e., topocentric observed HA &amp; Dec, is <cite>20</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">v6_hadec</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6_app</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="n">utc</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6_hadec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>
<span class="go">343.586827647</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">15.7683070508</span>
</pre></div>
</div>
<p>To calculate the observed RA we need to find the LAST, since TPM only
provides apparent RA. The observed RA can be found by subtracting hour
angle from LAST. This is one situation where we need to access the
underlying TPM machinery provided in <cite>pytpm.tpm</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tstate</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TSTATE</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpm</span><span class="o">.</span><span class="n">tpm_data</span><span class="p">(</span><span class="n">tstate</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TPM_INIT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tstate</span><span class="o">.</span><span class="n">utc</span> <span class="o">=</span> <span class="n">utc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tstate</span><span class="o">.</span><span class="n">delta_ut</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">delta_UT</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tstate</span><span class="o">.</span><span class="n">delta_at</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">delta_AT</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tstate</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="o">-</span><span class="mf">111.598333</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tstate</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mf">31.956389</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tpm</span><span class="o">.</span><span class="n">tpm_data</span><span class="p">(</span><span class="n">tstate</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TPM_ALL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">last</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2r</span><span class="p">(</span><span class="n">tstate</span><span class="o">.</span><span class="n">last</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">last</span> <span class="o">-</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">360.0</span>
<span class="go">185.85569737491355</span>
</pre></div>
</div>
<p>The same calculation with SLALIB, using <cite>sla_aop</cite> produces results that
agree with PyTPM.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dut</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">delta_UT</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">gcal2j</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c"># DUT for mid-day.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utc</span> <span class="o">=</span> <span class="n">slalib</span><span class="o">.</span><span class="n">sla_caldj</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span>  <span class="c"># mid-day.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tt</span> <span class="o">=</span> <span class="n">slalib</span><span class="o">.</span><span class="n">sla_dtt</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span> <span class="o">/</span> <span class="mf">86400.0</span> <span class="o">+</span> <span class="n">utc</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">slalib</span><span class="o">.</span><span class="n">sla_map</span><span class="p">(</span><span class="n">ra_j2000</span><span class="p">,</span> <span class="n">dec_j2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2000.0</span><span class="p">,</span>
<span class="go">   ...: tt)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="o">-</span><span class="mf">111.598333</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lat</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mf">31.956389</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">az</span><span class="p">,</span> <span class="n">zd</span><span class="p">,</span> <span class="n">ha</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">ra</span> <span class="o">=</span> <span class="n">slalib</span><span class="o">.</span><span class="n">sla_aop</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">utc</span><span class="p">,</span> <span class="n">dut</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span>
<span class="go">   ...: 2093.093, 0, 0, 273.15, 1013.25, 0, 0.550, 0.0065)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2r</span><span class="p">(</span><span class="n">az</span><span class="p">)),</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2r</span><span class="p">(</span><span class="n">zd</span><span class="p">))</span>
<span class="go">133.498195532 22.0162383595</span>
</pre></div>
</div>
<p>The hour angle, declination and right ascension are:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2r</span><span class="p">(</span><span class="n">ha</span><span class="p">))</span>
<span class="go">343.586827289</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2r</span><span class="p">(</span><span class="n">dec</span><span class="p">))</span>
<span class="go">15.7683143606</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">r2r</span><span class="p">(</span><span class="n">ra</span><span class="p">))</span>
<span class="go">185.855680678</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="comparisons.html"><em>Comparison of PyTPM with SLALIB</em></a> for a more detailed comparison between PyTPM and
SLALIB.</p>
</div>
<div class="section" id="converting-positions-and-velocities">
<span id="convert-pos-vel"></span><h2><a class="toc-backref" href="#id10">Converting positions and velocities</a><a class="headerlink" href="#converting-positions-and-velocities" title="Permalink to this headline">¶</a></h2>
<p>Converting position and velocities involve the exact same procedures as
in the above sections. The only difference is that we provide
velocities in addition to positions and the output will have both the
converted positions as well as the converted velocities.</p>
<p>All these files mentioned below are available in the <tt class="file docutils literal"><span class="pre">examples/</span></tt>
directory of the documentation source code (<tt class="file docutils literal"><span class="pre">_downloads</span></tt> in the
HTML distribution).</p>
<p>The examples shown here are available in
the <a class="reference download internal" href="_downloads/conversions.py"><tt class="xref download docutils literal"><span class="pre">examples/conversions.py</span></tt></a> file.</p>
<p>The file <a class="reference download internal" href="_downloads/hip_full.txt"><tt class="xref download docutils literal"><span class="pre">examples/hip_full.txt</span></tt></a> contains data from the
HIPPARCOS catalog. This file was generated using
the <a class="reference download internal" href="_downloads/hip_full.py"><tt class="xref download docutils literal"><span class="pre">examples/hip_full.py</span></tt></a> script. We will convert this data
between different coordinate systems.</p>
<p>The <cite>get_hipdata</cite> function below is one way of reading in the data
in <tt class="file docutils literal"><span class="pre">hip_full.txt</span></tt>. With table reading packages such as
<a class="reference external" href="http://cxc.harvard.edu/contrib/asciitable/">asciitable</a>, <a class="reference external" href="http://www.stecf.org/software/PYTHONtools/astroasciidata/">asciidata</a> and <a class="reference external" href="http://atpy.github.com/">atpy</a>, or the <cite>numpy.loadtxt</cite> function,
this function is not needed. The calculations are much easier to
perform with Numpy. PyTPM does not need Numpy or table reading
software. Hence I want to have examples that don&#8217;t use these, even
though the calculations are harder.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">pytpm</span> <span class="kn">import</span> <span class="n">tpm</span><span class="p">,</span> <span class="n">convert</span>

<span class="k">def</span> <span class="nf">get_hipdata</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return data in hip_full.txt.</span>

<span class="sd">    The data was created with hip_full.py file. Assumes that the file</span>
<span class="sd">    hip_full.txt is in the current directory.</span>

<span class="sd">    A dictionary is returned. All positions are in radians. Proper</span>
<span class="sd">    motions are in arc-sec per Julian century. Parallax is in</span>
<span class="sd">    arc-sec. The keys are:</span>

<span class="sd">      ra_icrs: ICRS RA</span>
<span class="sd">      dec_icrs: ICRS Dec</span>
<span class="sd">      raj2: RA J2000</span>
<span class="sd">      decj2: Dec J2000</span>
<span class="sd">      rab1: RA B1950</span>
<span class="sd">      decb1: Dec B1950</span>
<span class="sd">      glon: Galactic longitude (epoch J2000)</span>
<span class="sd">      glat: Galactic latitude (epoch J2000)</span>
<span class="sd">      elon2: Ecliptic longitude (epoch J2000)</span>
<span class="sd">      elat2: Ecliptic latitude (epoch J2000)</span>
<span class="sd">      pma: proper motion in RA (without cos(dec) factor)</span>
<span class="sd">      pmd: proper motion in Dec</span>
<span class="sd">      px: parallax.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;hip_full.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span>
                   <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ra_icrs</span><span class="o">=</span><span class="p">[],</span> <span class="n">dec_icrs</span><span class="o">=</span><span class="p">[],</span> <span class="n">px</span><span class="o">=</span><span class="p">[],</span> <span class="n">pma</span><span class="o">=</span><span class="p">[],</span> <span class="n">pmd</span><span class="o">=</span><span class="p">[],</span>
             <span class="n">raj2</span><span class="o">=</span><span class="p">[],</span> <span class="n">decj2</span><span class="o">=</span><span class="p">[],</span> <span class="n">rab1</span><span class="o">=</span><span class="p">[],</span> <span class="n">decb1</span><span class="o">=</span><span class="p">[],</span> <span class="n">glon</span><span class="o">=</span><span class="p">[],</span>
             <span class="n">glat</span><span class="o">=</span><span class="p">[],</span> <span class="n">elon2</span><span class="o">=</span><span class="p">[],</span> <span class="n">elat2</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;ra_icrs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;dec_icrs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;raj2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;decj2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;rab1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;decb1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;glon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">9</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;glat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">10</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;elon2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">11</span><span class="p">]))</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;elat2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span>

        <span class="c"># milli-arc-sec/jul yr to arc-sec per Jul. cent.</span>
        <span class="c"># And take out cos in RA proper motion.</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;pma&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;decj2&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;pmd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">)</span>

        <span class="c"># milli-arsec to arc-sec</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&quot;px&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>
</div>
<p>First read in the data and create <a class="reference internal" href="data_structures.html#pytpm.tpm.V6C" title="pytpm.tpm.V6C"><tt class="xref py py-class docutils literal"><span class="pre">tpm.V6C</span></tt></a> vectors. Since we
don&#8217;t have radial velocities, we will set it to 0.0.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hip_tab</span> <span class="o">=</span> <span class="n">get_hipdata</span><span class="p">()</span>
<span class="c"># Dummy radial velocities.</span>
<span class="n">rv</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;px&#39;</span><span class="p">]))]</span>
<span class="c"># Create V6C vectors.</span>
<span class="n">v6</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">cat2v6</span><span class="p">(</span><span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;raj2&#39;</span><span class="p">],</span> <span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;decj2&#39;</span><span class="p">],</span> <span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;pma&#39;</span><span class="p">],</span>
                <span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;pmd&#39;</span><span class="p">],</span> <span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;px&#39;</span><span class="p">],</span> <span class="n">rv</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">CJ</span><span class="p">)</span>
</pre></div>
</div>
<p>Subsequent steps are identical to those for converting positions. For
example for the FK5 to FK4 conversions we can do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Convert from FK5 equinox and epoch J2000.0 to FK4 equinox B1950, but</span>
<span class="c"># at the given epoch i.e., J2000.0.</span>
<span class="n">v6o</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">)</span>

<span class="c"># Apply proper motion from J2000.0 to B1950.0. Objects with zero</span>
<span class="c"># velocity in FK5 will have a fictitious proper motion in FK4.</span>
<span class="n">v6o</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">proper_motion</span><span class="p">(</span><span class="n">v6o</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">B1950</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span><span class="p">)</span>

<span class="c"># Convert V6C vectors into a list of dictionaries, each of which</span>
<span class="c"># contain the 6-D Fk4 B1950.0 coordinates.</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6o</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">CB</span><span class="p">)</span>
</pre></div>
</div>
<p>The variable <cite>cat</cite> will be a list of dictionaries, each containing the
FK4 coordinates of the corresponding entry in the <cite>hip_full.txt</cite> file.</p>
<p>We can print out the first of these and compare the result with the
FK4 data in <cite>hip_full.txt</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;rab1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c"># HIPPAROCS FK4 from Vizier.</span>
<span class="go"> 23H 57M 26.475S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>  <span class="c"># PyTPM output.</span>
<span class="go"> 23H 57M 26.474S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;decb1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">+00D 48&#39; 38.264&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">+00D 48&#39; 38.257&quot;</span>
</pre></div>
</div>
<p>Similarly FK5 to ecliptic conversion can be performed in the following
manner.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># FK5 equinox and epoch J2000.0, to IAU 1980 ecliptic J2000.0</span>
<span class="n">v6o</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">convertv6</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">s1</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">s2</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c"># Convert V6C vectors into a list of dictionaries, each of which</span>
<span class="c"># contain the 6-D Fk4 B1950.0 coordinates.</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">convert</span><span class="o">.</span><span class="n">v62cat</span><span class="p">(</span><span class="n">v6o</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">CJ</span><span class="p">)</span>
</pre></div>
</div>
<p>We can compare the result with that in the HIPPARCOS catalog returned
by Vizier.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;elon2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c"># Ecliptic data from Vizier cat.</span>
<span class="go"> 00H 01M 44.172S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">HMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;alpha&#39;</span><span class="p">])</span>  <span class="c"># PyTPM conversion of FK5.</span>
<span class="go"> 00H 01M 44.172S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">hip_tab</span><span class="p">[</span><span class="s">&#39;elat2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">+00D 59&#39; 55.604&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">tpm</span><span class="o">.</span><span class="n">DMS</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="s">&#39;delta&#39;</span><span class="p">])</span>
<span class="go">+00D 59&#39; 55.604&quot;</span>
</pre></div>
</div>
<p>All other conversions can be performed in the same manner.</p>
</div>
<div class="section" id="pytpm-and-tpm">
<h2><a class="toc-backref" href="#id11">PyTPM and TPM</a><a class="headerlink" href="#pytpm-and-tpm" title="Permalink to this headline">¶</a></h2>
<p>All the facilities of TPM can be used form within Python, using
functions and classes.</p>
<p>The following are C and Python code that perform equivalent
conversions. The code takes the FK5 J2000.0 equinox and epoch
coordinates of M100 through all coordinate systems defined in
TPM.</p>
<p>These, and the source code for the <cite>convert</cite> module, should allow
translation of TPM C code to PyTPM Python code.</p>
<p>These code fragments can be found
in <a class="reference download internal" href="_downloads/conversion_example.c"><tt class="xref download docutils literal"><span class="pre">examples/conversion_example.c</span></tt></a>
and <a class="reference download internal" href="_downloads/conversion_example.py"><tt class="xref download docutils literal"><span class="pre">examples/conversion_example.py</span></tt></a>, respectively.</p>
<p>Note that the conversions themselves are not accurate, since we do not
apply any proper motions. They are meant to compare C and Python code.</p>
<div class="section" id="c-code">
<h3><a class="toc-backref" href="#id12">C code</a><a class="headerlink" href="#c-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &quot;tpm/astro.h&quot;</span>
<span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;math.h&gt;</span>

<span class="cm">/* Take a coordinate through all states. */</span>
<span class="cm">/* Coordinates for M100 from SIMBAD. */</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
  <span class="kt">double</span> <span class="n">ra</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="mi">22</span><span class="o">/</span><span class="mf">60.0</span><span class="o">+</span><span class="mf">54.899</span><span class="o">/</span><span class="mf">3600.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M_PI</span><span class="o">/</span><span class="mf">24.0</span><span class="p">);</span>
  <span class="kt">double</span> <span class="n">de</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="mi">49</span><span class="o">/</span><span class="mf">60.0</span><span class="o">+</span><span class="mf">20.57</span><span class="o">/</span><span class="mf">3600.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M_PI</span><span class="o">/</span><span class="mf">360.0</span><span class="p">);</span>
  <span class="kt">double</span> <span class="n">ra1</span><span class="p">,</span> <span class="n">ra1_d</span><span class="p">,</span> <span class="n">de1</span><span class="p">,</span> <span class="n">de1_d</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">ep</span> <span class="o">=</span> <span class="n">J2000</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">J2000</span><span class="p">;</span>
  <span class="n">V6</span> <span class="n">v6</span><span class="p">;</span>
  <span class="n">V6</span> <span class="n">pvec</span><span class="p">[</span><span class="n">N_TPM_STATES</span><span class="p">];</span>
  <span class="n">TPM_TSTATE</span> <span class="n">tstate</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">TPM_S06</span><span class="p">;</span> <span class="cm">/* Heliocentric mean J2000 FK5 ~~ ICRS */</span>
  <span class="kt">int</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">TPM_S00</span><span class="p">;</span> <span class="cm">/* Assign required states. */</span>

  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">TPM_S00</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N_TPM_STATES</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">){</span>
    <span class="n">tpm_data</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tstate</span><span class="p">,</span> <span class="n">TPM_INIT</span><span class="p">);</span>
    <span class="n">tstate</span><span class="p">.</span><span class="n">utc</span> <span class="o">=</span> <span class="n">J2000</span><span class="p">;</span>
    <span class="n">tstate</span><span class="p">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">d2r</span><span class="p">(</span><span class="o">-</span><span class="mf">111.598333</span><span class="p">);</span>
    <span class="n">tstate</span><span class="p">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">d2r</span><span class="p">(</span><span class="mf">31.956389</span><span class="p">);</span>
    <span class="n">tstate</span><span class="p">.</span><span class="n">alt</span> <span class="o">=</span> <span class="mf">2093.093</span><span class="p">;</span>
    <span class="n">tstate</span><span class="p">.</span><span class="n">delta_ut</span> <span class="o">=</span> <span class="n">delta_UT</span><span class="p">(</span><span class="n">tstate</span><span class="p">.</span><span class="n">utc</span><span class="p">);</span>
    <span class="n">tpm_data</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tstate</span><span class="p">,</span> <span class="n">TPM_ALL</span><span class="p">);</span>

    <span class="n">v6</span> <span class="o">=</span> <span class="n">v6init</span><span class="p">(</span><span class="n">SPHERICAL</span><span class="p">);</span>
    <span class="n">v6SetR</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">);</span>
    <span class="n">v6SetAlpha</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">ra</span><span class="p">);</span>
    <span class="n">v6SetDelta</span><span class="p">(</span><span class="n">v6</span><span class="p">,</span> <span class="n">de</span><span class="p">);</span>

    <span class="n">pvec</span><span class="p">[</span><span class="n">s1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v6s2c</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">tpm</span><span class="p">(</span><span class="n">pvec</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">ep</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tstate</span><span class="p">);</span>
    <span class="n">v6</span> <span class="o">=</span> <span class="n">v6c2s</span><span class="p">(</span><span class="n">pvec</span><span class="p">[</span><span class="n">s2</span><span class="p">]);</span>

    <span class="n">ra1</span> <span class="o">=</span> <span class="n">v6GetAlpha</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
    <span class="n">de1</span> <span class="o">=</span> <span class="n">v6GetDelta</span><span class="p">(</span><span class="n">v6</span><span class="p">);</span>
    <span class="n">ra1_d</span> <span class="o">=</span> <span class="n">r2d</span><span class="p">(</span><span class="n">ra1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ra1_d</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="n">ra1_d</span> <span class="o">+=</span> <span class="mf">360.0</span><span class="p">;</span>
    <span class="n">de1_d</span> <span class="o">=</span> <span class="n">r2d</span><span class="p">(</span><span class="n">de1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">de1_d</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="n">de1_d</span> <span class="o">+=</span> <span class="mf">360.0</span><span class="p">;</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%02d-%02d %-17s %s %s %8.4f %8.4f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span>
      <span class="n">tpm_state</span><span class="p">(</span><span class="n">s2</span><span class="p">),</span> <span class="n">fmt_alpha</span><span class="p">(</span><span class="n">ra1</span><span class="p">),</span> <span class="n">fmt_delta</span><span class="p">(</span><span class="n">de1</span><span class="p">),</span> <span class="n">ra1_d</span><span class="p">,</span> <span class="n">de1_d</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="pytpm-code">
<span id="pytpm-full-conversion"></span><h3><a class="toc-backref" href="#id13">PyTPM code</a><a class="headerlink" href="#pytpm-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Take coordinates of M100 through all states.</span>
<span class="kn">from</span> <span class="nn">pytpm</span> <span class="kn">import</span> <span class="n">tpm</span>

<span class="n">ra</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">h2r</span><span class="p">(</span><span class="mi">12</span><span class="o">+</span><span class="mi">22</span><span class="o">/</span><span class="mf">60.0</span><span class="o">+</span><span class="mf">54.899</span><span class="o">/</span><span class="mf">3600.0</span><span class="p">)</span>
<span class="n">de</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="mi">49</span><span class="o">/</span><span class="mf">60.0</span><span class="o">+</span><span class="mf">20.57</span><span class="o">/</span><span class="mf">3600.0</span><span class="p">)</span>
<span class="n">ep</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TPM_S06</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TPM_S00</span>
<span class="n">tstate</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TSTATE</span><span class="p">()</span>
<span class="n">pvec</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">PVEC</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tpm</span><span class="o">.</span><span class="n">N_TPM_STATES</span><span class="p">):</span>
    <span class="n">tpm</span><span class="o">.</span><span class="n">tpm_data</span><span class="p">(</span><span class="n">tstate</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TPM_INIT</span><span class="p">)</span>
    <span class="n">tstate</span><span class="o">.</span><span class="n">utc</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">J2000</span>
    <span class="n">tstate</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="o">-</span><span class="mf">111.598333</span><span class="p">)</span>
    <span class="n">tstate</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">d2r</span><span class="p">(</span><span class="mf">31.956389</span><span class="p">)</span>
    <span class="n">tstate</span><span class="o">.</span><span class="n">alt</span> <span class="o">=</span> <span class="mf">2093.093</span>
    <span class="n">tstate</span><span class="o">.</span><span class="n">delta_ut</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">delta_UT</span><span class="p">(</span><span class="n">tstate</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
    <span class="n">tpm</span><span class="o">.</span><span class="n">tpm_data</span><span class="p">(</span><span class="n">tstate</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">TPM_ALL</span><span class="p">)</span>

    <span class="n">v6</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">V6S</span><span class="p">()</span>
    <span class="n">v6</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="mf">1e9</span>
    <span class="n">v6</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">ra</span>
    <span class="n">v6</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">de</span>


    <span class="n">pvec</span><span class="p">[</span><span class="n">s1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v6</span><span class="o">.</span><span class="n">s2c</span><span class="p">()</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">tpm</span><span class="o">.</span><span class="n">tpm</span><span class="p">(</span><span class="n">pvec</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">ep</span><span class="p">,</span> <span class="n">eq</span><span class="p">,</span> <span class="n">tstate</span><span class="p">)</span>
    <span class="n">v6</span> <span class="o">=</span> <span class="n">pvec</span><span class="p">[</span><span class="n">s2</span><span class="p">]</span><span class="o">.</span><span class="n">c2s</span><span class="p">()</span>

    <span class="n">ra1</span> <span class="o">=</span> <span class="n">v6</span><span class="o">.</span><span class="n">alpha</span>
    <span class="n">de1</span> <span class="o">=</span> <span class="n">v6</span><span class="o">.</span><span class="n">delta</span>
    <span class="n">ra1_d</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">ra1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ra1_d</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">:</span> <span class="n">ra1_d</span> <span class="o">+=</span> <span class="mf">360.0</span>
    <span class="n">de1_d</span> <span class="o">=</span> <span class="n">tpm</span><span class="o">.</span><span class="n">r2d</span><span class="p">(</span><span class="n">de1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">de1_d</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="p">:</span> <span class="n">de1_d</span> <span class="o">+=</span> <span class="mf">360.0</span>

    <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;{0:02d}-{1:02d} {2:&lt;17s} {3:s} {4:s} {5:8.4f} {6:8.4f}&quot;</span>
    <span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">tpm</span><span class="o">.</span><span class="n">tpm_state</span><span class="p">(</span><span class="n">s2</span><span class="p">),</span>
                   <span class="n">tpm</span><span class="o">.</span><span class="n">fmt_alpha</span><span class="p">(</span><span class="n">ra1</span><span class="p">),</span> <span class="n">tpm</span><span class="o">.</span><span class="n">fmt_delta</span><span class="p">(</span><span class="n">de1</span><span class="p">),</span> <span class="n">ra1_d</span><span class="p">,</span>
                   <span class="n">de1_d</span><span class="p">)</span>
</pre></div>
</div>
<p>We create a state structure, <a class="reference internal" href="data_structures.html#pytpm.tpm.TSTATE" title="pytpm.tpm.TSTATE"><tt class="xref py py-class docutils literal"><span class="pre">tpm.TSTATE</span></tt></a>, and initialize it by
calling
<a class="reference internal" href="functions.html#pytpm.tpm.tpm_data" title="pytpm.tpm.tpm_data"><tt class="xref py py-func docutils literal"><span class="pre">tpm.tpm_data()</span></tt></a> with <cite>TPM_INIT</cite>. Then we assign values to
independent parameters of the state data structure. We then calculate
all dependent state properties by calling <cite>tpm_data()</cite> and passing
<cite>TPM_ALL</cite>. We then create an array of <a class="reference internal" href="data_structures.html#pytpm.tpm.V6C" title="pytpm.tpm.V6C"><tt class="xref py py-class docutils literal"><span class="pre">tpm.V6C</span></tt></a> vectors, <cite>pvec</cite>
(<a class="reference internal" href="data_structures.html#pytpm.tpm.PVEC" title="pytpm.tpm.PVEC"><tt class="xref py py-class docutils literal"><span class="pre">tpm.PVEC</span></tt></a>), create a <cite>V6C</cite> vector for our object, and assign
it to the desired location in the array, based on the starting
state. We then call <a class="reference internal" href="functions.html#pytpm.tpm.tpm" title="pytpm.tpm.tpm"><tt class="xref py py-func docutils literal"><span class="pre">tpm.tpm()</span></tt></a> with the state structure and the
array of <cite>V6C</cite> vectors, along with the starting and ending state
numbers. Finally we retrieve the appropriate <cite>V6C</cite> vector from the
array, which will give us the final coordinates.</p>
<p>The result from running the above code is given below:</p>
<div class="highlight-python"><pre>06-00 null               12H 22M 54.898S +15D 49' 20.570" 185.7287  15.8224
06-01 Helio. mean FK4    12H 22M 54.824S +15D 49' 20.447" 185.7284  15.8223
06-02 Helio. mean FK5    12H 22M 54.898S +15D 49' 20.570" 185.7287  15.8224
06-03 IAU 1980 Ecliptic  11H 55M 07.815S +16D 45' 34.920" 178.7826  16.7597
06-04 IAU 1958 Galactic  18H 04M 32.673S +76D 53' 55.928" 271.1361  76.8989
06-05 Helio. mean FK4    12H 20M 22.935S +16D 05' 58.024" 185.0956  16.0995
06-06 Helio. mean FK5    12H 22M 54.898S +15D 49' 20.570" 185.7287  15.8224
06-07 Geoc. mean FK5     12H 22M 54.899S +15D 49' 20.569" 185.7287  15.8224
06-08 S07 + Light Defl.  12H 22M 54.898S +15D 49' 20.571" 185.7287  15.8224
06-09 S08 + Aberration   12H 22M 54.995S +15D 49' 13.474" 185.7291  15.8204
06-10 S09 + Precession   12H 22M 54.995S +15D 49' 13.474" 185.7291  15.8204
06-11 Geoc. app. FK5     12H 22M 54.045S +15D 49' 19.561" 185.7252  15.8221
06-12 Topo. mean FK5     12H 22M 54.899S +15D 49' 20.569" 185.7287  15.8224
06-13 S12 + Light Defl.  12H 22M 54.898S +15D 49' 20.571" 185.7287  15.8224
06-14 S13 + Aberration   12H 22M 55.013S +15D 49' 13.452" 185.7292  15.8204
06-15 S14 + Precession   12H 22M 55.013S +15D 49' 13.452" 185.7292  15.8204
06-16 Topo. app. FK5     12H 22M 54.063S +15D 49' 19.539" 185.7253  15.8221
06-17 Topo. app. HA/Dec  22H 52M 35.524S +15D 49' 19.539" 343.1480  15.8221
06-18 Topo. app. Az/El   08H 50M 11.837S +67D 45' 09.683" 132.5493  67.7527
06-19 Topo. obs. Az/El   08H 50M 11.837S +67D 45' 34.371" 132.5493  67.7595
06-20 Topo. obs. HA/Dec  22H 52M 36.636S +15D 49' 38.307" 343.1527  15.8273
06-21 Topo. obs. WHAM    22H 52M 56.457S -14D 49' 46.993" 343.2352 345.1703</pre>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Coordinate conversions using TPM and PyTPM</a><ul>
<li><a class="reference internal" href="#function-convert-convertv6">Function <cite>convert.convertv6</cite></a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-fk4-equinox-and-epoch-b1950-0">FK5 equinox and epoch J2000.0, to FK4 equinox and epoch B1950.0</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-iau-1958-galactic-system">FK5 equinox and epoch J2000.0, to IAU 1958 Galactic System</a></li>
<li><a class="reference internal" href="#iau-1958-galactic-to-fk5-equinox-and-epoch-j2000-0">IAU 1958 Galactic, to FK5 equinox and epoch J2000.0</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-iau-1980-ecliptic-system">FK5 equinox and epoch J2000.0, to IAU 1980 Ecliptic system</a></li>
<li><a class="reference internal" href="#iau-1980-ecliptic-system-to-fk5-equinox-and-epoch-j2000-0">IAU 1980 Ecliptic system, to FK5 equinox and epoch J2000.0</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-geocentric-apparent">FK5 equinox and epoch J2000.0, to Geocentric apparent</a></li>
<li><a class="reference internal" href="#fk5-equinox-and-epoch-j2000-0-to-topocentric-observed">FK5 equinox and epoch J2000.0, to topocentric observed</a></li>
<li><a class="reference internal" href="#converting-positions-and-velocities">Converting positions and velocities</a></li>
<li><a class="reference internal" href="#pytpm-and-tpm">PyTPM and TPM</a><ul>
<li><a class="reference internal" href="#c-code">C code</a></li>
<li><a class="reference internal" href="#pytpm-code">PyTPM code</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="comparisons.html"
                        title="next chapter">Comparison of PyTPM with SLALIB</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/conversions.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="comparisons.html" title="Comparison of PyTPM with SLALIB"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">PyTPM 0.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Prasanth Nair.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>